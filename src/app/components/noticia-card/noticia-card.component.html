<div class="noticia-card">
  <!-- Imagen de la noticia -->
  <div class="noticia-imagen">
    <img 
      [src]="noticia.imagen_url || 'assets/placeholder-news.jpg'" 
      [alt]="noticia.titulo"
    />
    <span class="categoria-badge" [class]="'categoria-' + noticia.categoria">
      {{ noticia.categoria }}
    </span>
  </div>

  <!-- Contenido de la noticia -->
  <div class="noticia-contenido">
    <!-- Título -->
    <h3 class="noticia-titulo">{{ noticia.titulo }}</h3>

    <!-- Metadata -->
    <div class="noticia-metadata">
      <span class="fuente">{{ noticia.nombre_fuente }}</span>
      <span class="separador">•</span>
      <span class="fecha">{{ formatearFecha(noticia.fecha_publicacion) }}</span>
      <span class="separador">•</span>
      <span class="pais">{{ noticia.pais }}</span>
    </div>

    <!-- Descripción -->
    <p class="noticia-descripcion">{{ noticia.contenido }}</p>

    <!-- Botón de Resumen con IA -->
    <div class="resumen-section">
      <button 
        class="btn-resumen"
        (click)="onGenerarResumenClick()"
        [disabled]="noticia.cargandoResumen || (!esPremium && !usuarioLogueado)"
        [class.loading]="noticia.cargandoResumen"
        [class.premium]="esPremium"
      >
        <!-- Icono de IA -->
        <svg class="icon-ai" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 2L2 7l10 5 10-5-10-5z"/>
          <path d="M2 17l10 5 10-5"/>
          <path d="M2 12l10 5 10-5"/>
        </svg>
        
        <!-- Texto del botón -->
        <span>{{ textoBotonResumen }}</span>
        
        <!-- Coronita Premium solo en el botón de resumen -->
        <svg *ngIf="esPremium" class="crown-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 2l2.4 7.4h7.6l-6 4.6 2.3 7.4-6.3-4.6-6.3 4.6 2.3-7.4-6-4.6h7.6z"/>
        </svg>
      </button>

      <!-- Contador de resúmenes (solo para usuarios gratuitos logueados) -->
      <div *ngIf="mostrarContadorResumenes" class="contador-resumenes">
        <span class="resumenes-info">
          {{ resumenesRestantes }} de {{ limiteResumenes }} resúmenes restantes hoy
        </span>
      </div>
    </div>

    <!-- Mostrar resumen cuando está generado -->
    <div *ngIf="noticia.resumen && noticia.mostrarResumen" class="resumen-contenido">
      <div class="resumen-header">
        <svg class="icon-sparkle" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 2L9 9l-7 3 7 3 3 7 3-7 7-3-7-3-3-7z"/>
        </svg>
        <span>Resumen generado por IA</span>
        
        <!-- Botón para cerrar resumen -->
        <button class="btn-cerrar-resumen" (click)="onCerrarResumenClick()" type="button">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>
      <p class="resumen-texto">{{ noticia.resumen }}</p>
    </div>

    <!-- Footer de la card -->
    <div class="noticia-footer">
      <a
        [href]="noticia.url_fuente"
        (click)="verOriginal($event)"
        target="_blank"
        rel="noopener noreferrer"
        class="btn-ver-original"
      >
        Ver noticia completa
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
          <polyline points="15 3 21 3 21 9"/>
          <line x1="10" y1="14" x2="21" y2="3"/>
        </svg>
      </a>
    </div>
  </div>
</div>